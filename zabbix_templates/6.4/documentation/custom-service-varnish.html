<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<style type="text/css">

   p.desc{
     white-space:nowrap;
   }

   table.pretty {
    margin: 1em 1em 1em 2em;
    background: whitesmoke;
    border-collapse: collapse;
   }

   table.pretty th, table.pretty td {
    border: 1px gainsboro solid;
    padding: 0.2em;
   }

   table.pretty th {
    background: gainsboro;
    text-align: left;
   }

   table.pretty caption {
    margin-left: inherit;
    margin-right: inherit;
    white-space:nowrap;
   }
  </style>
<body>
<h2>Macro Overview</h2>

  The following macros can be overloaded on host level.
  <table class="pretty">
<tr>
<th>Name</th><th>Default</th>
</tr>
<tr>
<td>{$HITRATE_PERCENTAGE}</td><td>20</td>
</tr>
<tr>
<td>{$HTTP_PORT_VARNISH}</td><td>6081</td>
</tr>
<tr>
<td>{$LOADBALANCER_CHECK_VARNISH}</td><td>/e/lbstatus.html</td>
</tr>
</table>
<h1>Static Elements</h1>
<h2>Trigger Overview</h2>
<table class="pretty">
<tr>
<th>Name</th><th>Description</th><th>Priority</th><th>Expression</th><th>Dependencies</th>
</tr>
<tr>
<td>Varnish Hitrate &lt; {$HITRATE_PERCENTAGE}%</td><td></td><td style="background-color:#FFFF00;">Warning</td><td><tt>((sum(/Custom - Service - Varnish/varnish.stat[cache_hit],#5) / (sum(/Custom - Service - Varnish/varnish.stat[cache_miss],#5) + sum(/Custom - Service - Varnish/varnish.stat[cache_hit],#5)))) &lt; ({$HITRATE_PERCENTAGE}/100)</tt></td><td><tt></tt></td>
</tr>
</table>
<h2>Graph Overview</h2>
<table class="pretty">
<tr>
<th>Name</th><th>Elements</th>
</tr>
<tr>
<td>Varnish Backend Connections</td><td><tt>varnish.stat[backend_fail]<br>varnish.stat[backend_unhealthy]<br>varnish.stat[backend_recycle]<br>varnish.stat[backend_reuse]<br>varnish.stat[backend_conn]<br>varnish.stat[backend_busy]<br>varnish.stat[backend_unused]<br>varnish.stat[backend_toolate]<br>varnish.stat[backend_req]<br>
</tt></td>
</tr>
<tr>
<td>Varnish Cache</td><td><tt>varnish.stat[cache_miss]<br>varnish.stat[cache_hitpass]<br>varnish.stat[cache_hit]<br>varnish.hitrate<br>
</tt></td>
</tr>
<tr>
<td>Varnish Client Connections</td><td><tt>varnish.stat[client_conn]<br>varnish.stat[client_req]<br>varnish.stat[client_drop]<br>varnish.stat[client_drop_late]<br>
</tt></td>
</tr>
<tr>
<td>Varnish  ESI</td><td><tt>varnish.stat[esi_errors]<br>varnish.stat[esi_warnings]<br>
</tt></td>
</tr>
<tr>
<td>Varnish Fetch</td><td><tt>varnish.stat[fetch_chunked]<br>varnish.stat[fetch_eof]<br>varnish.stat[fetch_failed]<br>varnish.stat[fetch_bad]<br>varnish.stat[fetch_head]<br>varnish.stat[fetch_oldhttp]<br>varnish.stat[fetch_close]<br>varnish.stat[fetch_length]<br>varnish.stat[fetch_zero]<br>
</tt></td>
</tr>
<tr>
<td>Varnish Object handling</td><td><tt>varnish.stat[n_expired]<br>varnish.stat[n_lru_moved]<br>varnish.stat[n_lru_nuked]<br>
</tt></td>
</tr>
<tr>
<td>Varnish Objects</td><td><tt>varnish.stat[n_object]<br>varnish.stat[n_objectcore]<br>varnish.stat[n_objecthead]<br>varnish.stat[n_vampireobject]<br>
</tt></td>
</tr>
<tr>
<td>Varnish  Sessions</td><td><tt>varnish.stat[n_objoverflow]<br>varnish.stat[n_objsendfile]<br>varnish.stat[n_objwrite]<br>varnish.stat[sess_closed]<br>varnish.stat[sess_herd]<br>varnish.stat[sess_linger]<br>varnish.stat[sess_pipeline]<br>varnish.stat[sess_readahead]<br>
</tt></td>
</tr>
<tr>
<td>Varnish  Workers</td><td><tt>varnish.stat[n_wrk_drop]<br>varnish.stat[n_wrk_overflow]<br>varnish.stat[n_wrk_queue]<br>varnish.stat[n_wrk]<br>varnish.stat[n_wrk_create]<br>varnish.stat[n_wrk_max]<br>varnish.stat[n_wrk_failed]<br>
</tt></td>
</tr>
</table>
<h2>Item Overview</h2>
<table class="pretty">
<tr>
<th>Type</th><th>Name</th><th>Key</th><th>Description</th><th>Interval (sec)</th><th>History Days</th><th>Trend Days</th>
</tr>
<tr>
<td>CALCULATED</td><td>Varnish Hitrate</td><td><tt>varnish.hitrate</tt></td><td></td><td>90</td><td></td><td>0</td>
</tr>
<tr>
<td></td><td>Backend conn. too many</td><td><tt>varnish.stat[backend_busy]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Backend conn. success</td><td><tt>varnish.stat[backend_conn]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Backend conn. failures</td><td><tt>varnish.stat[backend_fail]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Backend conn. recycles</td><td><tt>varnish.stat[backend_recycle]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Backend requests made</td><td><tt>varnish.stat[backend_req]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Backend conn. reuses</td><td><tt>varnish.stat[backend_reuse]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Backend conn. was closed</td><td><tt>varnish.stat[backend_toolate]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Backend conn. not attempted</td><td><tt>varnish.stat[backend_unhealthy]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Backend conn. unused</td><td><tt>varnish.stat[backend_unused]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Cache hitpass</td><td><tt>varnish.stat[cache_hitpass]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Cache hits</td><td><tt>varnish.stat[cache_hit]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Cache cache_miss</td><td><tt>varnish.stat[cache_miss]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Client connections accepted</td><td><tt>varnish.stat[client_conn]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Connection dropped, no sess/wrk</td><td><tt>varnish.stat[client_drop]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Connection dropped late</td><td><tt>varnish.stat[client_drop_late]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Client requests received</td><td><tt>varnish.stat[client_req]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>ESI parse errors (unlock)</td><td><tt>varnish.stat[esi_errors]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>ESI parse warnings (unlock)</td><td><tt>varnish.stat[esi_warnings]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Fetch had bad headers</td><td><tt>varnish.stat[fetch_bad]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Fetch chunked</td><td><tt>varnish.stat[fetch_chunked]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Fetch wanted close</td><td><tt>varnish.stat[fetch_close]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Fetch EOF</td><td><tt>varnish.stat[fetch_eof]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Fetch failed</td><td><tt>varnish.stat[fetch_failed]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Fetch head</td><td><tt>varnish.stat[fetch_head]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Fetch with Length</td><td><tt>varnish.stat[fetch_length]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Fetch pre HTTP/1.1 closed</td><td><tt>varnish.stat[fetch_oldhttp]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Fetch zero len</td><td><tt>varnish.stat[fetch_zero]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>N expired objects</td><td><tt>varnish.stat[n_expired]</tt></td><td></td><td>60</td><td></td><td></td>
</tr>
<tr>
<td></td><td>N LRU moved objects</td><td><tt>varnish.stat[n_lru_moved]</tt></td><td></td><td>60</td><td></td><td></td>
</tr>
<tr>
<td></td><td>N LRU nuked objects</td><td><tt>varnish.stat[n_lru_nuked]</tt></td><td></td><td>60</td><td></td><td></td>
</tr>
<tr>
<td></td><td>N struct objectcore</td><td><tt>varnish.stat[n_objectcore]</tt></td><td></td><td>60</td><td></td><td></td>
</tr>
<tr>
<td></td><td>N struct objecthead</td><td><tt>varnish.stat[n_objecthead]</tt></td><td></td><td>60</td><td></td><td></td>
</tr>
<tr>
<td></td><td>N struct object</td><td><tt>varnish.stat[n_object]</tt></td><td></td><td>60</td><td></td><td></td>
</tr>
<tr>
<td></td><td>Objects overflowing workspace</td><td><tt>varnish.stat[n_objoverflow]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Objects sent with sendfile</td><td><tt>varnish.stat[n_objsendfile]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Objects sent with write</td><td><tt>varnish.stat[n_objwrite]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>N unresurrected objects</td><td><tt>varnish.stat[n_vampireobject]</tt></td><td></td><td>60</td><td></td><td></td>
</tr>
<tr>
<td></td><td>N worker threads</td><td><tt>varnish.stat[n_wrk]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>N worker threads created</td><td><tt>varnish.stat[n_wrk_create]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>N dropped work requests</td><td><tt>varnish.stat[n_wrk_drop]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>N worker threads not created</td><td><tt>varnish.stat[n_wrk_failed]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>N worker threads limited</td><td><tt>varnish.stat[n_wrk_max]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>N overflowed work requests</td><td><tt>varnish.stat[n_wrk_overflow]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>N queued work requests</td><td><tt>varnish.stat[n_wrk_queue]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Session Closed</td><td><tt>varnish.stat[sess_closed]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Session herd</td><td><tt>varnish.stat[sess_herd]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Session Linger</td><td><tt>varnish.stat[sess_linger]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Session Pipeline</td><td><tt>varnish.stat[sess_pipeline]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Session Read Ahead</td><td><tt>varnish.stat[sess_readahead]</tt></td><td></td><td>90</td><td>14d</td><td>90d</td>
</tr>
<tr>
<td></td><td>Varnish Loadbalancer Health Check</td><td><tt>web.page.perf[127.0.0.1,{$LOADBALANCER_CHECK_VARNISH},{$HTTP_PORT_VARNISH}]</tt></td><td></td><td>60</td><td>14d</td><td>0</td>
</tr>
</table>
</body>
</html>
